## å‰è¨€

### ğŸŠç¼˜ç”±

####  ç‹—å“¥ä¹Ÿèƒ½ç©çš„å¾ˆèŠ±ï¼Œè°·æ­Œç™»å½•æ‰‹æ‹¿æŠŠæ

![](https://img.javadog.net/blog/google-login/3b435f269ec649a98a4ce0d68ede5d28.png)


ğŸ€äº‹æƒ…èµ·å› ï¼š

**å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯[JavaDogç¨‹åºç‹—](https://mp.weixin.qq.com/s/FjOdxCAPFrJpruhS1YB-MA)**

ä»Šå¤©ç»™å¤§å®¶æ¥åˆ†äº«ä¸€ä¸‹**è°·æ­Œæˆæƒç™»å½•ï¼Œä¸ç”¨åç«¯ï¼Œå‰ç«¯uniappç›´æ¥ç™»å½•ï¼Œå¹¶è·å–ç”¨æˆ·ä¿¡æ¯**

**ä½ æƒ³å¬çš„æ•…äº‹**


![](https://img.javadog.net/blog/google-login/f544ef16455046ae91261cf2115efb6c.png)


æœ¬ç‹—å¥½å‹ï¼Œæˆ‘ç§°å‘¼ä»–ã€ç£Šç£Šã€ï¼Œè¿œåœ¨æµ·å¤–çš„å¤§è€æ¿ã€‚

ç£Šç£Šä¸ºäº†æ‹“å±•æµ·å¤–å¸‚åœºï¼Œæ›¿å›½äº‰å…‰å»æŒ£è€ç¾çš„åˆ€ä¹ï¼Œé‚é‡‡ç”¨æœ¬ç‹—é¡¹ç›®[SpringBoot+uniapp+uviewæ‰“é€ H5+å°ç¨‹åº+APPå…¥é—¨å­¦ä¹ çš„èŠå¤©å°é¡¹ç›®](https://mp.weixin.qq.com/s/g7AZOWLgW5vcCahyJDEPKA) è¿›è¡ŒäºŒå¼€åŠ å…¥AIå…ƒç´ ï¼ŒåŒ…è£…åè¿›è¡ŒæŠ•èµ„å¼•æµã€‚

ç„¶è€Œè€ç¾éƒ½ä¹ æƒ¯ç”¨è°·æ­Œç™»å½•ï¼Œæ‰€ä»¥æœ¬ç‹—å°±ååŠ©ç£Šç£Šè¿›è¡Œä»£ç é‡æ„ï¼Œå¹¶å®ç°è°·æ­Œæˆæƒç™»å½•ï¼Œè™½ç„¶**å®˜ç½‘æœ‰å¤šç§å®ç°æ–¹å¼**ï¼Œä½†æ˜¯ç›®å‰é™åˆ¶è¾ƒå¤š(ç§‘å­¦é™åˆ¶)ï¼Œæœ¬ç‹—å°±å•ç‹¬é€‰æ‹©**å‰ç«¯ç›´è¿æˆæƒç™»å½•è·å–ä¿¡æ¯å®ä¾‹**ï¼Œè·Ÿå¤§å®¶è¿›è¡Œåˆ†äº«ã€‚

æœ¬æ–‡åªæ˜¯ç”¨å‰ç«¯å±•ç¤ºç®€å•æµç¨‹ï¼Œå®é™…é¡¹ç›®ä¸€å®šè¦é…åˆåç«¯åšå¥½å®‰å…¨é˜²æŠ¤ï¼Œä¿è¯æ•°æ®éšç§˜æ€§ã€‚


### ğŸå¦‚ä½•è·å–æºç 

å…¬ä¼—å·ï¼šã€JavaDogç¨‹åºç‹—ã€‘

å…³æ³¨å…¬ä¼—å·ï¼Œ**å‘é€  â€œgoogle-loginâ€**ï¼Œæ— ä»»ä½•å¥—è·¯å³å¯è·å¾—ï¼

![](https://img.javadog.net/blog/google-login/016f82a1ea3c414a91c2145fdd36b3d9.png)

![](https://img.javadog.net/blog/google-login/1199099b92284e7db4de53ee5878e475.png)



### ğŸ¯ä¸»è¦ç›®æ ‡

#### å®ç°3å¤§é‡ç‚¹

##### 1. è°·æ­Œæˆæƒç™»å½•æµç¨‹

##### 2. å¡«å†™è°·æ­Œå¼€å‘è€…æ§åˆ¶å°é…ç½®

##### 3. uniappå‰ç«¯æˆæƒç™»å½•å®æ“

### ğŸ¥¦ç›®æ ‡åˆ†æ

#### ä¸€. è°·æ­Œæˆæƒç™»å½•æµç¨‹

##### 1.ç”¨æˆ·ç‚¹å‡»ç™»å½•æŒ‰é’®ï¼š

ç”¨æˆ·åœ¨ä½ çš„åº”ç”¨ä¸Šç‚¹å‡»â€œä½¿ç”¨Googleç™»å½•â€æŒ‰é’®ã€‚

##### 2.é‡å®šå‘åˆ°Googleçš„æˆæƒæœåŠ¡å™¨ï¼š

åº”ç”¨å°†ç”¨æˆ·é‡å®šå‘åˆ°Googleçš„OAuth 2.0æˆæƒç«¯ç‚¹ï¼Œé™„å¸¦å®¢æˆ·ç«¯IDã€é‡å®šå‘URIã€å“åº”ç±»å‹ï¼ˆé€šå¸¸æ˜¯codeï¼‰ã€ä½œç”¨åŸŸï¼ˆscopeï¼‰ç­‰å‚æ•°ã€‚

##### 3.ç”¨æˆ·åŒæ„æˆæƒï¼š

ç”¨æˆ·åœ¨Googleç™»å½•é¡µé¢ä¸Šè¾“å…¥å‡­è¯å¹¶åŒæ„åº”ç”¨è¯·æ±‚çš„æƒé™ã€‚

##### 4.Googleé‡å®šå‘å›åº”ç”¨ï¼š

GoogleæˆæƒæœåŠ¡å™¨å°†ç”¨æˆ·é‡å®šå‘å›åº”ç”¨çš„é‡å®šå‘URIï¼Œå¹¶é™„å¸¦æˆæƒç ï¼ˆAuthorization Codeï¼‰ã€‚

##### 5.åº”ç”¨æœåŠ¡å™¨äº¤æ¢æˆæƒç ï¼š

åº”ç”¨æœåŠ¡å™¨å‘Googleçš„ä»¤ç‰Œç«¯ç‚¹å‘é€è¯·æ±‚ï¼Œç”¨æˆæƒç äº¤æ¢è®¿é—®ä»¤ç‰Œï¼ˆAccess Tokenï¼‰å’Œåˆ·æ–°ä»¤ç‰Œï¼ˆRefresh Tokenï¼‰ã€‚

##### 6.æ¥æ”¶è®¿é—®ä»¤ç‰Œï¼š

Googleè¿”å›è®¿é—®ä»¤ç‰Œå’Œå¯é€‰çš„åˆ·æ–°ä»¤ç‰Œï¼Œåº”ç”¨æœåŠ¡å™¨ä½¿ç”¨è®¿é—®ä»¤ç‰Œè®¿é—®Google APIã€‚

##### 7.è®¿é—®å—ä¿æŠ¤èµ„æºï¼š

åº”ç”¨æœåŠ¡å™¨ä½¿ç”¨è®¿é—®ä»¤ç‰Œå‘Google APIå‘é€è¯·æ±‚ï¼Œè·å–ç”¨æˆ·ä¿¡æ¯æˆ–å…¶ä»–èµ„æºã€‚

![](https://img.javadog.net/blog/google-login/e7542a0aab7a488090d81ced6c84aaab.png)

******

#### äºŒ. å¡«å†™è°·æ­Œå¼€å‘è€…æ§åˆ¶å°é…ç½®

ä»»ä½•OAuth2ç™»å½•æµç¨‹åŸºæœ¬éƒ½ä¸€è‡´ï¼Œ**è°·æ­Œç™»å½•ä¹Ÿä¸€æ ·ï¼Œéœ€è¦åœ¨å¼€å‘è€…ä¸­é…ç½®ä¸€äº›å¿…è¦æ¡ä»¶**ï¼Œå°±åƒæˆ‘ä»¬å¸¸åšçš„å¾®ä¿¡æˆæƒä¸€æ ·

##### 1. è®¿é—®å¼€å‘è€…é…ç½®å®˜ç½‘

[https://console.cloud.google.com/cloud-resource-manager](https://console.cloud.google.com/cloud-resource-manager)

åœ¨è°·æ­Œç®¡ç†èµ„æºé¡µé¢ï¼Œæˆ‘ä»¬è¦å…ˆ**åˆ›å»ºé¡¹ç›®**

![](https://img.javadog.net/blog/google-login/e31114876f9c4d1c89f054e7a18f43b2.png)

##### 2. åˆ›å»ºé¡¹ç›®

ç‚¹å‡»ã€åˆ›å»ºé¡¹ç›®ã€ï¼Œç„¶åå¡«å†™**é¡¹ç›®åç§°åŠä½ç½®**ï¼Œåç§°å¿…å¡«ï¼Œä½ç½®é»˜è®¤å³å¯ã€‚

åˆ›å»ºæˆåŠŸåä¼šåœ¨åˆ—è¡¨çœ‹åˆ°æˆ‘ä»¬åˆšåˆ›å»ºçš„é¡¹ç›®å

![](https://img.javadog.net/blog/google-login/55fc624b173b4238bbb299b945fc9cbe.png)

![](https://img.javadog.net/blog/google-login/ebf9184a054049b69144d34ba67690ba.png)

![](https://img.javadog.net/blog/google-login/a8c01a9199994b8cae8e3e3ad2bb9c7b.png)

##### 3. APIå’ŒæœåŠ¡é…ç½®

è¦æ˜¯ä¸å¥½æ‰¾**APIå’ŒæœåŠ¡é…ç½®**å¯ä»¥ç›´æ¥è®¿é—® [https://console.cloud.google.com/welcome](https://console.cloud.google.com/welcome)

åœ¨å½“å‰é¡¹ç›®ä¸‹ï¼Œç‚¹å‡»ã€APIå’ŒæœåŠ¡ã€ï¼ŒæƒŠé†’åç»­é…ç½®

![](https://img.javadog.net/blog/google-login/5ed880d31a214fe49666030d4a689864.png)

##### 4. åˆ›å»ºå®¢æˆ·ç«¯å‡­æ®

åœ¨**å‡­æ®**èœå•ä¸­ï¼Œç‚¹å‡»ã€åˆ›å»ºå‡­æ®ã€ï¼Œé€‰æ‹©**OAuthå®¢æˆ·ç«¯ID**ï¼Œç„¶åç‚¹å‡»é…ç½®åŒæ„å±å¹•

 â“ä»€ä¹ˆæ˜¯åŒæ„å±å¹•

> è°·æ­Œçš„â€œæˆæƒé…ç½®åŒæ„å±å¹•â€ï¼ˆOAuth Consent Screenï¼‰æ˜¯åœ¨OAuth 2.0æˆæƒæµç¨‹ä¸­å‘ç”¨æˆ·å±•ç¤ºçš„ä¸€ä¸ªç•Œé¢ï¼Œç”¨äºè¯·æ±‚ç”¨æˆ·çš„è®¸å¯ä»¥è®¿é—®å…¶è°·æ­Œè´¦æˆ·ä¸­çš„æ•°æ®æˆ–æ‰§è¡ŒæŸäº›æ“ä½œã€‚
> å½“ä½ çš„åº”ç”¨è¯•å›¾ä½¿ç”¨OAuthåè®®ä»è°·æ­Œè·å–ç”¨æˆ·æ•°æ®æ—¶ï¼Œç”¨æˆ·ä¼šè¢«é‡å®šå‘åˆ°è¿™ä¸ªå±å¹•ä¸Šï¼Œå®ƒä¼šæ˜¾ç¤ºåº”ç”¨çš„ä¸€äº›å…³é”®ä¿¡æ¯ï¼Œå¦‚åº”ç”¨åç§°ã€å›¾æ ‡ã€å¼€å‘è€…ä¿¡æ¯ä»¥åŠè¯·æ±‚çš„æƒé™èŒƒå›´ã€‚


![](https://img.javadog.net/blog/google-login/232cdafdeb634e16ab9dfc7394465e47.png)

![](https://img.javadog.net/blog/google-login/ed5af12e867a4815b1260f3e42b40ea1.png)

##### 5. OAuth æƒé™è¯·æ±‚é¡µé¢

åˆ›å»ºOAuthæƒé™è¯·æ±‚ï¼Œé€‰æ‹©ã€å¤–éƒ¨ã€ï¼Œåå¡«å†™åº”ç”¨ä¿¡æ¯ï¼Œå¦‚å¿…å¡«é¡¹**åº”ç”¨åç§°**ã€**ç”¨æˆ·æ”¯æŒç”µå­é‚®ä»¶**ã€**å¼€å‘è€…è”ç³»ä¿¡æ¯**ï¼Œå…¶ä½™å†…å®¹å¯ä»¥å…ˆé€‰æ‹©æ€§å¿½ç•¥ï¼Œä½†æ˜¯**æµ‹è¯•ç”¨æˆ·ä¸€å®šè¦åŠ ä¸Š**

![](https://img.javadog.net/blog/google-login/8a7447d7a84047939cb122da82f7ff65.png)

![](https://img.javadog.net/blog/google-login/c54d5c05de1a43a5a8e4be09818ecf80.png)

![](https://img.javadog.net/blog/google-login/9995bd8ae61b40328ed12157ce4ecd57.png)

![](https://img.javadog.net/blog/google-login/7afb152a06eb47c1a0d143fce8949051.png)

![](https://img.javadog.net/blog/google-login/e63a6af4a5c547c69ce610a09d7da20a.png)

##### 6. è¿”å›å‡­æ®åˆ›å»º OAuth å®¢æˆ·ç«¯ ID

è¿”å›**å‡­æ®**åˆ›å»ºã€å®¢æˆ·ç«¯ IDã€ï¼Œé€‰æ‹©åº”ç”¨ç±»å‹ã€Webåº”ç”¨ã€ï¼Œè¿›è¡Œ**å·²è·æˆæƒçš„JavaScript æ¥æº** å’Œ**å·²è·æˆæƒçš„é‡å®šå‘ URI**é…ç½®


![](https://img.javadog.net/blog/google-login/de3a731ca17241deb5d32d6de936414c.png)

![](https://img.javadog.net/blog/google-login/c993910f6fef41f38d77e8697e6d53a6.png)

 â“ä»€ä¹ˆæ˜¯å·²è·æˆæƒçš„ JavaScript æ¥æº

>  åœ¨è°·æ­Œæˆæƒç™»å½•ï¼ˆOAuth 2.0ï¼‰çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œâ€œå·²è·æˆæƒçš„JavaScriptæ¥æºâ€æ˜¯æŒ‡é‚£äº›è¢«å…è®¸ä½¿ç”¨ç‰¹å®šOAuthå®¢æˆ·ç«¯IDæ¥å‘èµ·èº«ä»½éªŒè¯å’Œæˆæƒè¯·æ±‚çš„ç½‘é¡µæˆ–Webåº”ç”¨çš„URLã€‚
>  å½“ä½ åœ¨Google Cloud Consoleä¸­æ³¨å†Œä¸€ä¸ªæ–°çš„OAuthå®¢æˆ·ç«¯æ—¶ï¼Œä½ å¯ä»¥æŒ‡å®šå“ªäº›æ¥æºï¼ˆå³åŸŸåæˆ–å®Œæ•´çš„URLï¼‰å¯ä»¥ä½¿ç”¨è¯¥å®¢æˆ·ç«¯IDæ¥ä¸Googleçš„èº«ä»½éªŒè¯æœåŠ¡è¿›è¡Œé€šä¿¡ã€‚

 ğŸ‘½äººè¯è§£é‡Š
 
 > ä¾‹å¦‚ï¼Œå¦‚æœç‹—å“¥æœ‰ä¸€ä¸ªè¿è¡Œåœ¨http://locahost:8080çš„Webåº”ç”¨ï¼Œå¹¶å¸Œæœ›ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨ä»–ä»¬çš„Googleè´¦æˆ·ç™»å½•ï¼Œéœ€è¦åœ¨Google Cloud Consoleä¸­å°†http://locahost:8080æ·»åŠ ä¸ºä¸€ä¸ª"å·²è·æˆæƒçš„JavaScriptæ¥æº

 â“ä»€ä¹ˆæ˜¯å·²è·æˆæƒçš„é‡å®šå‘ URI

> åœ¨è°·æ­Œæˆæƒç™»å½•ï¼ˆOAuth 2.0ï¼‰æµç¨‹ä¸­ï¼Œâ€œå·²è·æˆæƒçš„é‡å®šå‘URIâ€ï¼ˆAuthorized Redirect URIsï¼‰æ˜¯æŒ‡åœ¨ç”¨æˆ·å®Œæˆæˆæƒè¿‡ç¨‹åï¼ŒGoogleå°†æ§åˆ¶æƒå’Œæˆæƒç»“æœï¼ˆé€šå¸¸æ˜¯æˆæƒç æˆ–ç›´æ¥çš„è®¿é—®ä»¤ç‰Œï¼‰è¿”å›ç»™ä½ çš„åº”ç”¨çš„å…·ä½“URLã€‚

 ğŸ‘½äººè¯è§£é‡Š
 
 > å¦‚æœä½ çš„åº”ç”¨è¿è¡Œåœ¨http://locahost:8080ï¼Œå¹¶ä¸”ä½ å¸Œæœ›æ¥æ”¶æˆæƒç»“æœçš„è·¯å¾„æ˜¯http://locahost:8080ï¼Œé‚£ä¹ˆä½ å¯èƒ½éœ€è¦åœ¨Google Cloud Consoleä¸­æ³¨å†Œhttp://locahost:8080ä½œä¸ºä½ çš„é‡å®šå‘URIä¹‹ä¸€

![](https://img.javadog.net/blog/google-login/23e2ca820fac46cfbd4aec2522b435aa.png)

******

#### ä¸‰. uniappå‰ç«¯æˆæƒç™»å½•å®æ“

é€šè¿‡ä¸Šæ–¹äºŒå¡«å†™äº†å¼€å‘è€…ç›¸å…³é…ç½®ï¼Œå°±å¯ä»¥è¿›è¡Œå‰ç«¯ä»£ç å¤„ç†ï¼Œ**æºç åœ¨ä¸Šæ–¹ï¼Œå…³æ³¨è‡ªè¡Œé¢†å–**

##### 1.ä»£ç ç»“æ„

ä»£ç ç»“æ„éå¸¸ç®€å•ï¼Œå°±æ˜¯æœ€åŸºç¡€çš„uniappåˆå§‹åŒ–é¡µé¢

![](https://img.javadog.net/blog/google-login/7dedb1e014f84e1092e7a04192e5f988.png)

##### 2.å…³é”®ä»£ç 

- **è·å–è°·æ­Œæˆæƒç code**ï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–¹æµç¨‹å›¾ä¸­çš„ç¬¬1-4æ­¥

![](https://img.javadog.net/blog/google-login/57742388d194429fb94a96b91ae20c48.png)


```js
 auth() {
      // ä½ çš„Google OAuth å®¢æˆ·ç«¯ ID
      window.clientId =
          'æ›¿æ¢æˆä½ çš„Google OAuth å®¢æˆ·ç«¯ ID';
      // é‡å®šå‘ URI
      window.redirectUri = 'http://localhost:8080';
      // è¯·æ±‚çš„æƒé™èŒƒå›´ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚ä¿®æ”¹
      window.scope = 'email profile';
      // ç”¨äºé˜²æ­¢è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰æ”»å‡»ï¼Œå¯ä»¥ä¸è®¾ç½®ï¼Œå¯ä»¥éšå¿ƒè®¾ç½®
      window.state = '';
      // æˆæƒå“åº”ç±»å‹ï¼Œè¡¨ç¤ºè¦æ±‚è¿”å›æˆæƒç 
      window.responseType = 'code';
      // ä½ çš„Google OAuth å®¢æˆ·ç«¯å¯†é’¥
      window.clientSecret = 'æ›¿æ¢æˆä½ çš„Google OAuth å®¢æˆ·ç«¯å¯†é’¥';
      window.grantType = 'authorization_code';
      //&prompt=login æŠŠå®ƒåŠ åˆ°window.authUrlçš„æœ«å°¾å¯ä»¥è®©ç”¨æˆ·æ¯æ¬¡éƒ½éœ€è¦é‡æ–°è¾“å…¥è´¦å·å’Œå¯†ç 
      window.authUrl =
          `https://accounts.google.com/o/oauth2/v2/auth?client_id=${window.clientId}&redirect_uri=${window.redirectUri}&scope=${window.scope}&state=${window.state}&response_type=${window.responseType}`;
      //ç‚¹å‡»Googleç™»å½•  æ‰§è¡Œè¿™ä¸ªæ–¹æ³•è¿›è¡Œè·³è½¬
      window.location.href = window.authUrl
    },
```

- **æˆæƒç codeæ¢å–è®¿é—®ä»¤ç‰Œï¼Œå¹¶é€šè¿‡ä»¤ç‰Œè·å–ç”¨æˆ·ä¿¡æ¯**ï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–¹æµç¨‹å›¾ä¸­çš„ç¬¬5-7æ­¥

![](https://img.javadog.net/blog/google-login/ecb2efb2a38e42dbb51af726dde55466.png)

```js
getUserInfo() {
      const urlParams = new URLSearchParams(window.location.search);
      const code = urlParams.get('code');
      if (!code) {
        return
      }
      // ç”¨æˆæƒç äº¤æ¢è®¿é—®ä»¤ç‰Œåœ°å€
      const tokenEndpoint = 'https://oauth2.googleapis.com/token';
      const requestBody = new URLSearchParams();
      requestBody.append('code', code);
      // ä½ çš„ Google OAuth å®¢æˆ·ç«¯ ID
      requestBody.append('client_id',
          'æ›¿æ¢æˆä½ çš„Google OAuth å®¢æˆ·ç«¯ ID');
      // ä½ çš„Google OAuth å®¢æˆ·ç«¯å¯†é’¥
      requestBody.append('client_secret', 'æ›¿æ¢æˆä½ çš„Google OAuth å®¢æˆ·ç«¯å¯†é’¥');
      requestBody.append('redirect_uri', 'http://localhost:8080');
      requestBody.append('grant_type', 'authorization_code'); //è¿™äº›å‚æ•°åœ¨ä¹‹å‰é…ç½®çš„æœ‰ï¼Œçœ‹å‰é¢çš„ä»£ç 

      fetch(tokenEndpoint, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: requestBody
      })
          .then(response => response.json())
          .then(data => {
            // è·å¾—tokenä»¤ç‰Œçš„ä¿¡æ¯
            const accessToken = data.access_token;
            // è°ƒç”¨è·å–ç”¨æˆ·ä¿¡æ¯æ¥å£
            fetch('https://www.googleapis.com/oauth2/v2/userinfo', {
              headers: {
                Authorization: `Bearer ${accessToken}`
              }
            })
                .then(response => response.json())
                .then(userInfo => {
                  // è·å–ç”¨æˆ·ä¿¡æ¯
                  this.title = userInfo.name
                  this.pic = userInfo.picture
                  this.email = userInfo.email
                  console.log(userInfo)
                })

          })
    },
```

- **å®Œæ•´ä»£ç **

```html
<template>
  <view class="content">
    <image class="logo" :src="pic"/>
    <view class="title">{{ title }}</view>
    <view class="title">{{ email }}</view>
    <view class="title">
      <button type="primary" style="margin-top: 10px" @click="auth">è°·æ­Œæˆæƒç™»å½•</button>
    </view>

  </view>
</template>

<script>
export default {
  data() {
    return {
      title: 'Hello',
      pic: '/static/logo.png',
      email: ''
    }
  },
  onLoad() {
    this.getUserInfo();
  },
  methods: {
    getUserInfo() {
      const urlParams = new URLSearchParams(window.location.search);
      const code = urlParams.get('code');
      if (!code) {
        return
      }
      // ç”¨æˆæƒç äº¤æ¢è®¿é—®ä»¤ç‰Œåœ°å€
      const tokenEndpoint = 'https://oauth2.googleapis.com/token';
      const requestBody = new URLSearchParams();
      requestBody.append('code', code);
      // ä½ çš„ Google OAuth å®¢æˆ·ç«¯ ID
      requestBody.append('client_id',
          'æ›¿æ¢æˆä½ çš„Google OAuth å®¢æˆ·ç«¯ ID');
      // ä½ çš„Google OAuth å®¢æˆ·ç«¯å¯†é’¥
      requestBody.append('client_secret', 'æ›¿æ¢æˆä½ çš„Google OAuth å®¢æˆ·ç«¯å¯†é’¥');
      requestBody.append('redirect_uri', 'http://localhost:8080');
      requestBody.append('grant_type', 'authorization_code'); 

      fetch(tokenEndpoint, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: requestBody
      })
          .then(response => response.json())
          .then(data => {
            // è·å¾—tokenä»¤ç‰Œçš„ä¿¡æ¯
            const accessToken = data.access_token;
            // è°ƒç”¨è·å–ç”¨æˆ·ä¿¡æ¯æ¥å£
            fetch('https://www.googleapis.com/oauth2/v2/userinfo', {
              headers: {
                Authorization: `Bearer ${accessToken}`
              }
            })
                .then(response => response.json())
                .then(userInfo => {
                  // è·å–ç”¨æˆ·ä¿¡æ¯
                  this.title = userInfo.name
                  this.pic = userInfo.picture
                  this.email = userInfo.email
                  console.log(userInfo)
                })

          })
    },
    auth() {
      // ä½ çš„Google OAuth å®¢æˆ·ç«¯ ID
      window.clientId =
          'æ›¿æ¢æˆä½ çš„Google OAuth å®¢æˆ·ç«¯ ID';
      // é‡å®šå‘ URI
      window.redirectUri = 'http://localhost:8080';
      // è¯·æ±‚çš„æƒé™èŒƒå›´ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚ä¿®æ”¹
      window.scope = 'email profile';
      // ç”¨äºé˜²æ­¢è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰æ”»å‡»ï¼Œå¯ä»¥ä¸è®¾ç½®ï¼Œå¯ä»¥éšå¿ƒè®¾ç½®
      window.state = '';
      // æˆæƒå“åº”ç±»å‹ï¼Œè¡¨ç¤ºè¦æ±‚è¿”å›æˆæƒç 
      window.responseType = 'code';
      // ä½ çš„Google OAuth å®¢æˆ·ç«¯å¯†é’¥
      window.clientSecret = 'æ›¿æ¢æˆä½ çš„Google OAuth å®¢æˆ·ç«¯å¯†é’¥';
      window.grantType = 'authorization_code';
      //&prompt=login æŠŠå®ƒåŠ åˆ°window.authUrlçš„æœ«å°¾å¯ä»¥è®©ç”¨æˆ·æ¯æ¬¡éƒ½éœ€è¦é‡æ–°è¾“å…¥è´¦å·å’Œå¯†ç 
      window.authUrl =
          `https://accounts.google.com/o/oauth2/v2/auth?client_id=${window.clientId}&redirect_uri=${window.redirectUri}&scope=${window.scope}&state=${window.state}&response_type=${window.responseType}`;
      //ç‚¹å‡»Googleç™»å½•  æ‰§è¡Œè¿™ä¸ªæ–¹æ³•è¿›è¡Œè·³è½¬
      window.location.href = window.authUrl
    },
  }
}
</script>

<style>
.content {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.logo {
  height: 200 rpx;
  width: 200 rpx;
  margin: 200 rpx auto 50 rpx;
  margin-top: 40 rpx;
}

.title {
  font-size: 36 rpx;
  color: #8f8f94;
  margin-top: 20 rpx;
}
</style>

```

##### 3.å¯åŠ¨è°ƒè¯•

- å¯åŠ¨uniappç¨‹åºï¼Œç‚¹å‡»**è¿è¡Œ** =ã€‹**è¿è¡Œåˆ°æµè§ˆå™¨** =ã€‹**Chrome**

![](https://img.javadog.net/blog/google-login/df8fbe59a84744aba0b29f8fcbb81a37.png)

- æŸ¥çœ‹å¯åŠ¨æˆåŠŸé¡µé¢ï¼Œé»˜è®¤ä¸ºhttp://localhost:8080

æœ¬ç‹—å¤„ç†ä¸šåŠ¡çš„é¡µé¢å°±åœ¨http://localhost:8080ï¼Œå› æ­¤å¯¹åº”è°·æ­Œå¼€å‘è€…é…ç½®çš„ **å·²è·æˆæƒçš„JavaScript æ¥æº** å’Œ**å·²è·æˆæƒçš„é‡å®šå‘ URI**ä¸¤è€…ä¹Ÿå¡«å†™çš„http://localhost:8080

![](https://img.javadog.net/blog/google-login/e0b3b6da576a473fbb5c9872d42faa87.png)

##### 4.æˆæœå±•ç¤º

- è®¿é—®http://localhost:8080

![](https://img.javadog.net/blog/google-login/e4d877aaf3934f90a9b0f2404926e91c.png)

- ç‚¹å‡»ç™»å½•ï¼Œè·³è½¬è°·æ­Œæˆæƒç™»å½•é¡µé¢

![](https://img.javadog.net/blog/google-login/31fccb8e431c422a84ddcaa123b0b20e.png)

- è¾“å…¥å¯†ç ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥

![](https://img.javadog.net/blog/google-login/ca8cffc8d7c64b77a44b97057cd9a95e.png)

- ç¡®è®¤æˆæƒ

![](https://img.javadog.net/blog/google-login/21aa0008ab1b47588666fecf4d407bae.png)

- æˆæƒæˆåŠŸé‡å®šå‘å›åº”ç”¨é¡µé¢ï¼Œå¹¶è·å–è·¯å¾„ä¸­å¸¦çš„æˆæƒç ï¼Œäº¤æ¢è®¿é—®ä»¤ç‰Œå¹¶è°ƒç”¨è·å–ç”¨æˆ·ä¿¡æ¯æ¥å£

![](https://img.javadog.net/blog/google-login/3daffbe0786e4c2e8bcf60a34c0231b9.png)

##### 5.å¼‚å¸¸æƒ…å†µ

- é¡µé¢ç‚¹å‡»ç™»å½•é¡µé¢æ²¡æœ‰è·³è½¬è°·æ­Œ

	ç½‘ç»œè¢«æŒ¡ä½äº†
	
![](https://img.javadog.net/blog/google-login/3c3d98ae2b0244dbb91b3873916678d4.png)

- è°·æ­ŒæˆæƒæˆåŠŸæ²¡æœ‰è·³å›åº”ç”¨é¡µé¢

	æ£€æŸ¥é…ç½®çš„**å·²è·æˆæƒçš„é‡å®šå‘ URI**åœ°å€

![](https://img.javadog.net/blog/google-login/38a38387b2a54aa19f2cc3d8cb63f7a2.png)

- ä½¿ç”¨ä»¤ç‰Œè°ƒç”¨è·å–ç”¨æˆ·ä¿¡æ¯æ¥å£403

	æ£€æŸ¥æµ‹è¯•ç”¨æˆ·æ˜¯å¦æ·»åŠ 

![](https://img.javadog.net/blog/google-login/17a3000043b647edb87bc4e0d57cffa8.png)

## æ€»ç»“


æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†å¦‚ä½•åœ¨uniappé¡¹ç›®ä¸­é›†æˆè°·æ­Œæˆæƒç™»å½•åŠŸèƒ½ï¼Œæ— éœ€åç«¯ä»‹å…¥ï¼Œç›´æ¥ä»å‰ç«¯å®ç°ã€‚ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š
1. è°·æ­Œæˆæƒç™»å½•æµç¨‹ï¼š

	é˜è¿°äº†ä»**ç”¨æˆ·ç‚¹å‡»ç™»å½•æŒ‰é’®åˆ°æœ€ç»ˆè·å–ç”¨æˆ·ä¿¡æ¯çš„æ•´ä¸ªOAuth 2.0æµç¨‹**ï¼ŒåŒ…æ‹¬**é‡å®šå‘è‡³GoogleæˆæƒæœåŠ¡å™¨ã€ç”¨æˆ·åŒæ„æˆæƒã€Googleé‡å®šå‘å›åº”ç”¨ã€åº”ç”¨æœåŠ¡å™¨äº¤æ¢æˆæƒç ã€æ¥æ”¶è®¿é—®ä»¤ç‰Œä»¥åŠè®¿é—®å—ä¿æŠ¤èµ„æº**ã€‚
	
2. è°·æ­Œå¼€å‘è€…é…ç½®ï¼š
	
	å¦‚ä½•åœ¨Google Cloud Consoleä¸­**åˆ›å»ºé¡¹ç›®ã€é…ç½®åŒæ„å±å¹•ã€åˆ›å»ºOAuthå®¢æˆ·ç«¯IDï¼Œå¹¶è®¾ç½®å¿…è¦çš„å·²è·æˆæƒçš„JavaScriptæ¥æºå’Œé‡å®šå‘URI**ï¼Œç¡®ä¿å‰ç«¯åº”ç”¨èƒ½æ­£ç¡®ä¸Google OAuthç³»ç»Ÿäº¤äº’ã€‚

3. uniappå‰ç«¯æˆæƒç™»å½•å®æ“ï¼š

	æä¾›äº†å…·ä½“çš„**uniappä»£ç ç¤ºä¾‹**ï¼ŒåŒ…æ‹¬**å¦‚ä½•æ„é€ æˆæƒè¯·æ±‚URLä»¥è·å–æˆæƒç ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨æˆæƒç äº¤æ¢è®¿é—®ä»¤ç‰Œï¼Œå¹¶é€šè¿‡è®¿é—®ä»¤ç‰Œè·å–ç”¨æˆ·ä¿¡æ¯**ã€‚ä»£ç ä¸­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨fetchAPIä¸Google OAuthç³»ç»Ÿé€šä¿¡ï¼Œè·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯å¦‚å§“åã€å¤´åƒå’Œé‚®ç®±


### ğŸˆçŒœä½ æƒ³é—®

####  å¦‚ä½•ä¸ç‹—å“¥è”ç³»è¿›è¡Œæ¢è®¨

##### å…³æ³¨å…¬ä¼—å·ã€JavaDogç¨‹åºç‹—ã€‘

å…¬ä¼—å·å›å¤ã€å…¥ç¾¤ã€‘æˆ–è€…ã€åŠ å…¥ã€‘ï¼Œä¾¿å¯æˆä¸ºã€ç¨‹åºå‘˜å­¦ä¹ äº¤æµæ‘¸é±¼ç¾¤ã€‘çš„ä¸€å‘˜ï¼Œé—®é¢˜éšä¾¿é—®ï¼Œç‰›é€¼éšä¾¿å¹ï¼Œç›®å‰**ç¾¤å†…å·²æœ‰è¶…è¿‡290+ä¸ªå°ä¼™ä¼´å•¦**ï¼ï¼ï¼

![](https://img.javadog.net/blog/java-lock/2998b2a49f7dc8c8ddd3a345e5694422.png)

##### 2.è¸©è¸©ç‹—å“¥åšå®¢

[javadog.net](https://www.javadog.net/)

**é‡Œé¢æœ‰ç‹—å“¥çš„ç§å¯†è”ç³»æ–¹å¼å‘¦ ğŸ˜˜**

>å¤§å®¶å¯ä»¥åœ¨é‡Œé¢ç•™è¨€ï¼Œéšæ„å‘æŒ¥ï¼Œæœ‰é—®å¿…ç­”

![](https://img.javadog.net/blog/java-lock/7e380641de0de84f8d07a0d85dabe389.png)

******

###  ğŸ¯çŒœä½ å–œæ¬¢

####  æ–‡ç« æ¨è

[ã€Javaã€‘@Transactionaläº‹åŠ¡å¥—ç€ReentrantLocké”ï¼Œé”ç«Ÿç„¶å¤±æ•ˆè¶…å–äº†](https://mp.weixin.qq.com/s/QkvbWRleIaNAH_Txo1aUZg)

[ã€è§„èŒƒã€‘Gitåˆ†æ”¯ç®¡ç†ï¼Œçœ‹çœ‹æˆ‘å¸æ˜¯å’‹æ•´çš„](https://mp.weixin.qq.com/s/8LRB9k-4EsgSN1lCy5az8A)

[ã€å·¥å…·ã€‘çè—å…è´¹å®è—å·¥å…·ï¼Œä¸å¥½ç”¨ä½ æ¥æ¶æˆ‘](https://mp.weixin.qq.com/s/Mj5--CQVaafs_bInMCgUaQ)

[ã€æ’ä»¶ã€‘IDEAè¿™æ¬¾æ’ä»¶ï¼Œçˆ±åˆ°æ— æ³•è‡ªæ‹”](https://mp.weixin.qq.com/s/IePixEWV5JMG1X2R4mwt6g)

[ã€è§„èŒƒã€‘çœ‹çœ‹äººå®¶Gitæäº¤æè¿°ï¼Œé‚£å«ä¸€ä¸ªè§„çŸ©](https://mp.weixin.qq.com/s/EbNWRpSYMdWFv5aUQ2ockw)

[ã€å·¥å…·ã€‘ç”¨nvmç®¡ç†nodejsç‰ˆæœ¬åˆ‡æ¢ï¼ŒçœŸé¦™ï¼](https://mp.weixin.qq.com/s/N6qwQpH-oIgFGSWIVDJ-2g)

[ã€é¡¹ç›®å®æˆ˜ã€‘SpringBoot+uniapp+uview2æ‰“é€ H5+å°ç¨‹åº+APPå…¥é—¨å­¦ä¹ çš„èŠå¤©å°é¡¹ç›®](https://mp.weixin.qq.com/s/g7AZOWLgW5vcCahyJDEPKA)

[ã€é¡¹ç›®å®æˆ˜ã€‘SpringBoot+uniapp+uview2æ‰“é€ ä¸€ä¸ªä¼ä¸šé»‘çº¢åå•åæ§½å°ç¨‹åº](https://mp.weixin.qq.com/s/t_qwF_HvkdW-6TI3sYUHrA)

[ã€æ¨¡å—åˆ†å±‚ã€‘è¿˜ä¸ä¼šSpringBooté¡¹ç›®æ¨¡å—åˆ†å±‚ï¼Ÿæ¥è¿™æ‰‹æŠŠæ‰‹æ•™ä½ ï¼](https://mp.weixin.qq.com/s/fpkiNR2tj832a6VxZozwDg)

 
![](https://img.javadog.net/blog/java-lock/5ee9ad70af6c2ec5d3730bd0c15565e6.jpg)